<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SolarPurify System - Smart Water Purification | By Getrude Chizana 2025</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Bootstrap Icons -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
    rel="stylesheet"
  />
  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>

  <style>
    /* Reset & base */
    body, html {
      margin: 0; padding: 0; height: 100%;
      font-family: 'Montserrat', sans-serif;
      background: #f5f9ff;
      color: #2c3e50;
      overflow-x: hidden;
      min-height: 100vh;
    }

    #app {
      display: flex;
      min-height: 100vh;
      flex-direction: column;
      transition: padding-left 0.3s ease;
    }

    /* Sidebar */
    aside.sidebar {
      width: 300px;
      background: #1a237e;
      color: #fff;
      display: flex;
      flex-direction: column;
      transition: transform 0.33s ease;
      z-index: 1050;
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      overflow-y: auto;
      padding-bottom: 1rem;
      box-shadow: 2px 0 12px rgba(0,0,0,0.3);
    }

    aside.sidebar .brand {
      font-weight: 700;
      font-size: 1.5rem;
      padding: 1.5rem 2rem;
      border-bottom: 1px solid #3949ab;
      user-select: none;
      white-space: nowrap;
    }

    aside.sidebar nav a {
      display: flex;
      align-items: center;
      padding: 1rem 2rem;
      color: #c5cae9;
      font-weight: 500;
      text-decoration: none;
      border-left: 4px solid transparent;
      transition: background 0.25s, border-color 0.25s;
      white-space: nowrap;
      user-select: none;
    }

    aside.sidebar nav a:hover,
    aside.sidebar nav a.active {
      background: #3949ab;
      border-left-color: #ffca28;
      color: #fff;
    }

    aside.sidebar nav a i {
      margin-right: 12px;
      font-size: 1.3rem;
      flex-shrink: 0;
    }

    aside.sidebar nav a#logoutLink {
      margin-top: auto;
      color: #ff7043;
      font-weight: 600;
      border-left-color: transparent !important;
      user-select: none;
    }

    aside.sidebar nav a#logoutLink:hover {
      background: #e65100;
      color: #fff;
      border-left-color: #ffca28 !important;
    }

    /* Hide sidebar initially on mobile */
    aside.sidebar.hidden {
      transform: translateX(-100%);
      position: fixed;
      box-shadow: none;
    }

    /* Sidebar overlay for mobile */
    .overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1040;
    }

    .overlay.show {
      display: block;
    }

    /* Main content */
    main.content {
      background: #f5f9ff;
      flex-grow: 1;
      min-height: 100vh;
      margin-left: 0;
      transition: margin-left 0.3s ease;
      overflow-y: auto;
      padding: 1rem 2rem 2rem 2rem;
      box-sizing: border-box;
      user-select: none;
    }

    main.with-sidebar {
      margin-left: 300px;
    }

    /* Hamburger */
    #hamburger {
      display: none;
      position: fixed;
      top: 16px;
      left: 16px;
      z-index: 1100;
      background-color: #1a237e;
      border: none;
      border-radius: 5px;
      width: 44px;
      height: 44px;
      color: white;
      font-size: 1.8rem;
      cursor: pointer;
      transition: background-color 0.3s ease;
      user-select: none;
    }

    #hamburger:hover {
      background-color: #3949ab;
    }

    /* Pages container */
    .pages {
      max-width: 100vw;text-align:center;
      margin: 0 auto;
    }

    /* Hero section full screen */
    .hero-fullscreen {
      height: 100vh;
      width: 100%;
      background:
        linear-gradient(to bottom right, rgba(26,35,126,0.85), rgba(255,202,40,0.7)),
        url('https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1470&q=80') no-repeat center center/cover;
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 0 2rem;
      box-shadow: 0 8px 30px rgba(26,35,126,0.55);
      user-select: none;
      margin-bottom: 3rem;
    }

    .hero-fullscreen h1 {
      font-size: 4rem;
      font-weight: 900;
      letter-spacing: 1.05px;
      margin-bottom: 0.5rem;
      text-shadow: 2px 2px 6px rgba(0,0,0,0.7);
    }

    .hero-fullscreen p {
      font-size: 1.5rem;
      max-width: 750px;
      margin-bottom: 2.5rem;
      text-shadow: 1px 1px 6px rgba(0,0,0,0.55);
    }

    .hero-fullscreen button {
      font-size: 1.3rem;
      padding: 0.85rem 4rem;
      border-radius: 35px;
      border: none;
      background-color: #ffca28;
      color: #1a237e;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(255,202,40,0.7);
      transition: background-color 0.3s ease;
    }

    .hero-fullscreen button:hover,
    .hero-fullscreen button:focus {
      background-color: #fbc02d;
      outline: none;
    }

    /* Content sections */
    section.content-section {
           margin: 3rem auto;
      padding: 2rem 2rem 3rem 2rem;
      border-radius: 14px;
      background: white;
      box-shadow: 0 10px 28px rgb(0 0 0 / 0.08);
      user-select: text;
    }

    section.content-section h2 {
      font-weight: 800;
      margin-bottom: 1.2rem;
      color: #1a237e;
      border-bottom: 4px solid #ffca28;
      padding-bottom: 0.4rem;
      user-select: text;
    }

    section.content-section p,
    section.content-section ul,
    section.content-section ol {
      font-size: 1.1rem;
      line-height: 1.7;
      color: #34495e;
    }

    section.content-section ul,
    section.content-section ol {
      padding-left: 1.5rem;
    }

    section.content-section ul li,
    section.content-section ol li {
      margin-bottom: 0.5rem;
    }

    /* Table styling */
    table.table-bordered {
      background: white;
      box-shadow: 0 0 22px rgb(0 0 0 / 0.06);
      border-radius: 12px;
    }

    /* Dashboard hero */
    #dashboard-hero {
      background: url('https://images.unsplash.com/photo-1517816743773-6e0fd518b4a6?auto=format&fit=crop&w=1470&q=80') no-repeat center center/cover;
      margin: 2rem auto 3rem;
      border-radius: 14px;
      color: white;
      max-width: 960px;
      padding: 6rem 3rem;
      text-align: center;
      box-shadow: 0 10px 34px rgb(26 35 126 / 0.7);
      user-select: none;
    }

    #dashboard-hero h1 {
      font-size: 3.6rem;
      font-weight: 900;
      margin-bottom: 1rem;
      text-shadow: 0 4px 14px rgba(0,0,0,0.7);
    }

    #dashboard-hero p {
      font-size: 1.5rem;
      font-weight: 600;
      max-width: 750px;
      margin: 0 auto;
      text-shadow: 0 3px 10px rgba(0,0,0,0.6);
    }

    /* Dashboard stats cards */
    .stats-grid {
      max-width: 960px;
      margin: 0 auto 3.5rem;
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(280px,1fr));
      gap: 1.8rem;
      padding: 0 1rem;
    }

    .stat-card {
      background: white;
      border-radius: 14px;
      padding: 2rem 2.8rem;
      box-shadow: 0 14px 32px rgb(0 0 0 / 0.08);
      display: flex;
      align-items: center;
      gap: 1.8rem;
      transition: transform 0.32s ease, box-shadow 0.32s ease;
      user-select: none;
    }

    .stat-card:hover {
      transform: translateY(-7px);
      box-shadow: 0 26px 38px rgb(255 202 40 / 0.5);
    }

    .stat-icon {
      font-size: 4.2rem;
      color: #ffca28;
      flex-shrink: 0;
    }

    .stat-info h4 {
      margin: 0;
      color: #1a237e;
      font-weight: 900;
      font-size: 1.3rem;
    }

    .stat-info p {
      font-size: 2.4rem;
      font-weight: 900;
      color: #34495e;
      margin: 3px 0 0;
      letter-spacing: 1.1px;
    }

    /* Chart container */
    .charts-wrapper {
      max-width: 960px;
      margin: 0 auto 3.5rem;
      padding: 0 1rem;
      display: grid;
      gap: 2rem;
      grid-template-columns: repeat(auto-fit,minmax(320px,1fr));
    }

    .chart-card {
      background: white;
      box-shadow: 0 12px 28px rgb(0 0 0 / 0.12);
      border-radius: 14px;
      padding: 2rem 2.4rem;
      user-select: none;
    }

    .chart-card h5 {
      color: #1a237e;
      margin-bottom: 1.2rem;
      font-weight: 900;
      display: flex;
      align-items: center;
      gap: 0.7rem;
      user-select: none;
      letter-spacing: 0.6px;
      font-size: 1.25rem;
    }

    /* Manage Units Section */
    #manage section {
      max-width: 960px;
      margin: 2rem auto;
      padding: 0 1rem;
      user-select: text;
    }

    /* Form controls */
    .form-control, .form-select {
      border-radius: 10px;
      box-shadow: none !important;
      border: 2.3px solid #ced4da;
      font-size: 1.1rem;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
      border-color: #ffca28;
      box-shadow: 0 0 12px #ffd54faa;
      outline: none;
    }

    /* Buttons */
    button.btn-primary {
      background: #1a237e;
      border: none;
      padding: 0.75rem 2.8rem;
      font-weight: 900;
      border-radius: 10px;
      box-shadow: 0 4px 14px rgb(26 35 126 / 0.48);
      transition: background-color 0.3s ease;
      user-select: none;
      font-size: 1.15rem;
    }

    button.btn-primary:hover,
    button.btn-primary:focus {
      background-color: #3949ab;
      outline: none;
    }

    table.table {
      background: white;
      border-radius: 14px;
      overflow: hidden;
      border-collapse: separate !important;
      border-spacing: 0 6px;
    }

    table.table thead tr th {
      position: sticky;
      top: 0;
      background-color: #c5cae9;
      color: #1a237e;
      font-weight: 700;
      font-size: 1.15rem;
      user-select: none;
      z-index: 10;
      box-shadow: inset 0 -3px 0 #ffca28;
      border-bottom: none !important;
    }

    table.table tbody tr {
      background: #f7f9ff;
      transition: background 0.3s ease;
      border-radius: 12px;
    }
    table.table tbody tr:hover {
      background-color: #eaf1ff;
      cursor: pointer;
    }

    table.table tbody tr td {
      vertical-align: middle;
      padding: 1rem 1.4rem;
      color: #34495e;
      font-weight: 600;
    }
    table.table tbody tr td.text-center button {
      transition: color 0.25s ease;
      font-size: 1.15rem;
    }
    table.table tbody tr td.text-center button:hover {
      color: #ffca28;
    }

    /* Accessibility focused outlines */
    a:focus,
    button:focus,
    input:focus,
    select:focus {
      outline: 3px solid #ffca28;
      outline-offset: 3px;
    }

    /* Images styling in content sections */
    section.content-section img {
      max-width: 100%;
      margin-top: 1rem;
      border-radius: 14px;
      box-shadow: 0 10px 28px rgb(0 0 0 / 0.15);
      user-select: none;
    }

    /* Responsive tweaks */
    @media(max-width: 992px) {
      #hamburger {
        display: block;
      }

      aside.sidebar {
        transform: translateX(-100%);
        box-shadow: 6px 0 26px rgba(0,0,0,0.25);
      }

      aside.sidebar.open {
        transform: translateX(0);
      }

      .overlay.show {
        display: block;
      }

      main.content.with-sidebar {
        margin-left: 0 !important;
      }

      /* Adjust hero fullscreen height on small */
      .hero-fullscreen {
        height: 55vh;
        padding: 1.5rem 1rem;
      }

      .hero-fullscreen h1 {
        font-size: 2.9rem;
      }

      .hero-fullscreen p {
        font-size: 1.2rem;
      }
    }

  </style>
</head>
<body>

<!-- Hamburger for Mobile -->
<button
  id="hamburger"
  aria-label="Toggle menu"
  aria-expanded="false"
  aria-controls="sidebar" style="right:0;"
>
  <i class="bi bi-list"></i>
</button>

<!-- Sidebar -->
<aside
  id="sidebar"
  class="sidebar hidden"
  role="complementary"
  aria-label="Main navigation sidebar"
  
>
  <div class="brand">
    SolarPurify <span style="color:#ffca28">System</span><br />
    <small style="font-weight:400; font-size:0.8rem; color:#c5cae9"
      >By Getrude Chizana - HIT 2025</small
    >
  </div>
  <nav aria-label="Primary navigation">
    <a href="#" class="active" data-page="welcome"
      ><i class="bi bi-house-door-fill"></i> Welcome</a
    >
    <a href="#" data-page="about"
      ><i class="bi bi-info-circle-fill"></i> About System</a
    >
    <a href="#" data-page="howto"
      ><i class="bi bi-play-btn-fill"></i> How to Operate</a
    >
    <a href="#" data-page="contact"
      ><i class="bi bi-envelope-fill"></i> Contact</a
    >
    <a href="#" data-page="developer"
      ><i class="bi bi-person-badge-fill"></i> Developer Info</a
    >
    <a href="#" data-page="dashboard"
      ><i class="bi bi-speedometer2"></i> Dashboard</a
    >
    <a href="#" data-page="manage"
      ><i class="bi bi-pencil-square"></i> Manage Units</a
    >
    <a href="#" id="logoutLink"
      ><i class="bi bi-box-arrow-right"></i> Logout</a
    >
  </nav>
</aside>

<!-- Overlay for mobile -->
<div id="overlay" class="overlay"></div>

<!-- Main content area -->
<main class="content" aria-live="polite" role="main">
  <div class="pages">
    <!-- WELCOME -->
    <section
      id="welcome"
      class="page-section"
      role="region"
      aria-label="Welcome page"
    >
      <div class="hero-fullscreen" role="banner" aria-label="Welcome hero">
        <h1>Welcome to SolarPurify</h1>
        <p>
          Smart solar-powered water purification designed to serve rural communities sustainably
          and effectively.
        </p>
<p>The credentials to use here are "user" for username and "user" for password. Thank you.</p>
        <button id="btnLogin" aria-haspopup="dialog" aria-controls="loginModal"
          >Log In</button
        >
      </div>

      <section class="content-section" aria-label="About the system">
        <h2>About the System</h2>
        <p>
          SolarPurify provides an eco-friendly, digital water purification solution powered fully by
          solar energy. It combines advanced filtration with IoT monitoring for safe,
          affordable water to rural communities.
        </p>
        <img
          src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1000&q=80"
          alt="Solar panels under bright sun"
          loading="lazy"
          draggable="false"
        />
      </section>

      <section class="content-section" aria-label="How to operate the system">
        <h2>How to Operate</h2>
        <p>
          Before starting purification, monitor your water tank level and system status. Use the control panel
          to start or stop purification safely. The system auto-regulates to prevent overflow or faults.
        </p>
        <img
          src="https://media.istockphoto.com/id/532863828/photo/main-water-shutoff-valve-hand-shutting-off-lever-controls-supply.jpg?s=612x612&w=0&k=20&c=P2uAVw7MsI2HrYMFkiLJCqFqqxKEd6i6wdDz_pg0TLg="
          alt="Hand operating a water valve"
          loading="lazy"
          draggable="false"
        />
      </section>

     
      <!-- Removed Getrude Chizana pic as per request -->

      <section class="content-section" aria-label="Developer information">
        <h2>Developer</h2>
        <p>
          <strong>Getrude Chizana</strong><br />
          Diploma in Integrated Telecommunication Engineering<br />
          Harare Institute of Technology, 2025
        </p>
      </section>
    </section>


    <!-- ABOUT PAGE -->
    <section
      id="about"
      role="region"
      aria-label="About system"
      class="page-section d-none"
    >
      <div class="content-section">
        <h2>About the System</h2>
        <p>
          SolarPurify delivers a green, smart water purification solution for rural areas. Leveraging solar energy
          and IoT, it ensures clean water access with low operational costs and real-time control.
        </p>
      </div>
      <img
        src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=1200&q=80"
        alt="Solar water purification system illustration"
        loading="lazy"
        style="max-width: 900px; margin-left: auto; margin-right: auto; display: block; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.1);"
        draggable="false"
      />
    </section>

    <!-- HOW TO OPERATE PAGE -->
    <section
      id="howto"
      role="region"
      aria-label="How to operate"
      class="page-section d-none"
    >
      <div class="content-section">
        <h2>How to Operate</h2>
        <p>
          The system monitors key parameters to ensure safe and efficient water purification.
          Follow these steps:
        </p>
        <ol>
          <li>Check your water tank level displayed on the dashboard.</li>
          <li>Review system status for alerts or warnings.</li>
          <li>Use the Start Purification button to begin filtering water.</li>
          <li>The system will automatically stop if abnormal conditions occur.</li>
          <li>Use Stop Purification button to manually halt the process if needed.</li>
        </ol>
             </div>
    </section>

  
 <section>
        <h2>Contact</h2>
        <p>
          For support, inquiries, or training, please reach out:
        </p>
        <ul  style="text-align:left;">
          <li>Email: <a href="gchizana@gmail.com">gchizana@gmail.com</a></li>
          <li>Phone: +263 786284536</li>
          <li>Address: Harare Institute of Technology, Zimbabwe</li>
        </ul>
      </section>

    <!-- DEVELOPER INFO PAGE -->
    <section
      id="developer"
      role="region"
      aria-label="Developer information"
      class="page-section d-none"
    >
      <div class="content-section">
        <h2>Developer</h2>
        <p>
          <strong>Getrude Chizana</strong><br />
          Diploma in Integrated Telecommunication Engineering<br />
          Harare Institute of Technology, 2025
        </p>
      </div>
    </section>

    <!-- DASHBOARD -->
    <section
      id="dashboard"
      class="page-section d-none"
      aria-label="Dashboard overview"
    >
      <div
        id="dashboard-hero"
        role="region"
        aria-label="Dashboard welcome banner"
      >
        <h1>Water Purification Made Easy And Smart</h1>
        <p>
          Use the sidebar menu to explore reports, manage units, monitor water levels,
          and control the purification system.
        </p>
      </div>

      <div class="stats-grid" role="region" aria-label="System statistics">

        <!-- 25 Functional Stats / Info Boxes (5 IoT controls highlighted) -->

        <article class="stat-card" aria-live="polite" aria-atomic="true" aria-label="Solar panels active">
          <i class="bi bi-sun-fill stat-icon" aria-hidden="true"></i>
          <div class="stat-info">
            <h4>Solar Panels Active</h4>
            <p id="statSolar">0</p>
          </div>
        </article>

        <article class="stat-card" aria-live="polite" aria-atomic="true" aria-label="Purified water liters">
          <i class="bi bi-droplet-fill stat-icon" aria-hidden="true"></i>
          <div class="stat-info">
            <h4>Purified Water (Liters)</h4>
            <p id="statWater">0</p>
          </div>
        </article>

        <article class="stat-card" aria-live="polite" aria-atomic="true" aria-label="System alerts count">
          <i class="bi bi-exclamation-triangle-fill stat-icon" aria-hidden="true"></i>
          <div class="stat-info">
            <h4>System Alerts</h4>
            <p id="statAlerts">0</p>
          </div>
        </article>

        <!-- Additional 22 info/statistics examples -->
        <article class="stat-card" aria-label="Battery charge percentage">
          <i class="bi bi-battery-full stat-icon" aria-hidden="true" style="color:#198754"></i>
          <div class="stat-info">
            <h4>Battery Charge (%)</h4>
            <p id="statBattery">78%</p>
          </div>
        </article>

        <article class="stat-card" aria-label="Water tank capacity liters">
          <i class="bi bi-speedometer2 stat-icon" aria-hidden="true" style="color:#0dcaf0"></i>
          <div class="stat-info">
            <h4>Water Tank Capacity (L)</h4>
            <p id="statTankCap">1500</p>
          </div>
        </article>

        <article class="stat-card" aria-label="Daily Water Purified liters">
          <i class="bi bi-clock stat-icon" aria-hidden="true" style="color:#ffc107"></i>
          <div class="stat-info">
            <h4>Daily Water Purified (L)</h4>
            <p id="statDailyWater">1280</p>
          </div>
        </article>

        <article class="stat-card" aria-label="System uptime hours">
          <i class="bi bi-toggle-on stat-icon" aria-hidden="true" style="color:#6f42c1"></i>
          <div class="stat-info">
            <h4>System Uptime (hrs)</h4>
            <p id="statUptime">112</p>
          </div>
        </article>

        <article class="stat-card" aria-label="Last maintenance date">
          <i class="bi bi-tools stat-icon" aria-hidden="true" style="color:#dc3545"></i>
          <div class="stat-info">
            <h4>Last Maintenance</h4>
            <p id="statMaintenance">2025-07-10</p>
          </div>
        </article>

        <!-- IoT control stats, 5 controls -->
        <article class="stat-card" aria-label="Water Pump Status">
          <i class="bi bi-droplet-half stat-icon" aria-hidden="true" style="color:#0d6efd"></i>
          <div class="stat-info">
            <h4>Water Pump Status</h4>
            <p id="statPumpStatus">OFF</p>
          </div>
        </article>

        <article class="stat-card"aria-label="Valve Status">
          <i class="bi bi-funnel-fill stat-icon" aria-hidden="true" style="color:#198754"></i>
          <div class="stat-info">
            <h4>Valve Status</h4>
            <p id="statValveStatus">OPEN</p>
          </div>
        </article>

        <article class="stat-card"aria-label="Solar Panel Output Watts">
          <i class="bi bi-lightning-charge-fill stat-icon" aria-hidden="true" style="color:#fd7e14"></i>
          <div class="stat-info">
            <h4>Solar Output (Watts)</h4>
            <p id="statSolarWatts">420</p>
          </div>
        </article>

        <article class="stat-card"aria-label="Battery Voltage">
          <i class="bi bi-battery-half stat-icon" aria-hidden="true" style="color:#6c757d"></i>
          <div class="stat-info">
            <h4>Battery Voltage</h4>
            <p id="statBatteryVolt">12.6 V</p>
          </div>
        </article>

        <article class="stat-card"aria-label="Water Flow Rate liters per minute">
          <i class="bi bi-arrow-up-circle-fill stat-icon" aria-hidden="true" style="color:#0dcaf0"></i>
          <div class="stat-info">
            <h4>Water Flow Rate (L/min)</h4>
            <p id="statFlowRate">15</p>
          </div>
        </article>

        <!-- You can add placeholders for remaining 14 stats as needed. For brevity, these 15+ cover IoT + stats -->

      </div>

      <div class="charts-wrapper" aria-label="Dashboard charts">
        <section class="chart-card" aria-label="Solar panel usage chart">
          <h5><i class="bi bi-pie-chart-fill"></i> Solar Panel Usage</h5>
          <canvas
            id="chartSolar"
            role="img"
            aria-label="Pie chart showing solar panel usage"
          ></canvas>
        </section>
        <section class="chart-card" aria-label="Water purification volume chart">
          <h5><i class="bi bi-bar-chart-fill"></i> Water Purification Volume</h5>
          <canvas
            id="chartWater"
            role="img"
            aria-label="Bar chart showing purified water volume"
          ></canvas>
        </section>
        <section class="chart-card" aria-label="Alerts over time chart">
          <h5><i class="bi bi-graph-up-arrow"></i> Alerts Over Time</h5>
          <canvas
            id="chartAlerts"
            role="img"
            aria-label="Line chart showing system alerts over time"
          ></canvas>
        </section>
      </div>

      <!-- Water Level & Purification Controls -->
      <section
        class="content-section"
        aria-label="Water Level and Purification Control"
      >
        <h2>Water Level & Purification Control</h2>

        <div class="mb-4">
          <h5>Water Level Status:</h5>
          <p id="waterLevelDesc" class="lead">Loading...</p>
          <img
            id="waterLevelImg"
            src="https://images.unsplash.com/photo-1573496772780-2c2f990f50db?auto=format&fit=crop&w=1000&q=60"
            alt="Water tank"
            style="max-width: 400px; border-radius: 12px; box-shadow: 0 6px 20px rgba(0,0,0,0.15); user-select:none;"
            draggable="false"
          />
        </div>

        <div>
          <h5>Purification Process Controls:</h5>
          <p>
            Use the buttons below to start or stop the purification process. The system will
            automatically prevent overflow and stop if water levels are low.
          </p>
          <div class="d-flex gap-3 flex-wrap">
            <button id="btnStartPurify" class="btn btn-success" aria-label="Start purification process" disabled>
              <i class="bi bi-play-circle-fill me-2"></i> Start Purification
            </button>
            <button id="btnStopPurify" class="btn btn-danger" aria-label="Stop purification process" disabled>
              <i class="bi bi-stop-circle-fill me-2"></i> Stop Purification
            </button>
          </div>
          <p id="purifyStatus" class="mt-3 fw-semibold" aria-live="polite"></p>
        </div>
      </section>
    </section>

    <!-- MANAGE UNITS -->
    <section
      id="manage"
      class="page-section d-none"
      
      aria-label="Manage purification units"
    >
      <div class="content-section">
        <h2>Manage Purification Units</h2>
        <p>
          Add, update, or remove purification units. Your data is saved locally in your
          browser.
        </p>
        <form id="unitForm" class="row g-3 align-items-center" novalidate>
          <div class="col-md-5">
            <label for="inputUnitName" class="form-label">Unit Name</label>
            <input
              type="text"
              id="inputUnitName"
              class="form-control"
              required
              aria-required="true"
              placeholder="Enter unit name"
            />
            <div class="invalid-feedback">Please provide a unit name.</div>
          </div>
          <div class="col-md-4">
            <label for="selectUnitStatus" class="form-label">Status</label>
            <select
              id="selectUnitStatus"
              class="form-select"
              required
              aria-required="true"
            >
              <option value="" selected disabled>Select status</option>
              <option value="Active">Active</option>
              <option value="Maintenance">Maintenance</option>
              <option value="Inactive">Inactive</option>
            </select>
            <div class="invalid-feedback">Please select a status.</div>
          </div>
          <div class="col-md-3 d-grid">
            <button type="submit" class="btn btn-primary mt-4" id="btnAddUnit">
              <i class="bi bi-plus-circle me-2"></i>Add Unit
            </button>
          </div>
        </form>

        <div
          class="table-responsive mt-4 mb-5"
          style="max-height:400px; overflow-y:auto"
        >
          <table
            class="table table-hover align-middle border"
            id="unitsTable"
            aria-describedby="unitsTableDesc"
          >
            <caption id="unitsTableDesc">
              List of purification units with editing options
            </caption>
            <thead class="table-primary sticky-top" style="top:0; z-index:10;">
              <tr>
                <th scope="col">Unit Name</th>
                <th scope="col">Status</th>
                <th scope="col" class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody><!-- Dynamically added units --></tbody>
          </table>
        </div>
      </div>
    </section>
  </div>
</main>

<!-- Overlay -->
<div id="overlay" class="overlay"></div>

<!-- Login Modal -->
<div
  class="modal fade"
  id="loginModal"
  
  aria-labelledby="loginModalLabel"
  aria-hidden="true"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
>
  <div class="modal-dialog modal-dialog-centered modal-sm">
    <div class="modal-content rounded-4 shadow-lg">
      <div class="modal-header border-bottom-0">
        <h5 class="modal-title fw-bold" id="loginModalLabel">
          <i class="bi bi-person-circle me-2"></i>User Login
        </h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close login modal"
        ></button>
      </div>
      <form id="loginForm" novalidate>
        <div class="modal-body pb-0">
          <div class="mb-3">
            <label for="loginUsername" class="form-label">Username</label>
            <input
              type="text"
              class="form-control rounded-3"
              id="loginUsername"
              name="username"
              required
              autocomplete="username"
              aria-required="true"
            />
            <div class="invalid-feedback">Please enter your username.</div>
          </div>
          <div class="mb-3">
            <label for="loginPassword" class="form-label">Password</label>
            <input
              type="password"
              class="form-control rounded-3"
              id="loginPassword"
              name="password"
              required
              autocomplete="current-password"
              aria-required="true"
            />
            <div class="invalid-feedback">Please enter your password.</div>
          </div>
        </div>
        <div class="modal-footer pt-0 px-3 border-top-0">
          <button
            type="button"
            class="btn btn-outline-secondary"
            data-bs-dismiss="modal"
            aria-label="Cancel login" style="background:red;color:white;"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="btn btn-primary"
            aria-label="Submit login form"
          >
            <i class="bi bi-box-arrow-in-right me-2"></i>Login
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<footer
  class="text-center py-3"
  style="font-size: 0.9rem; background: #e1e9ff; color: #283593"
>
  © 2025 Getrude Chizana - Harare Institute of Technology. All rights reserved.
</footer>

<!-- Bootstrap Bundle JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  (() => {
    "use strict";

    // Credentials
    const USER = "user";
    const PASS = "user";

    // DOM Elements
    const sidebar = document.getElementById("sidebar");
    const sidebarLinks = sidebar.querySelectorAll("nav a:not(#logoutLink)");
    const logoutLink = document.getElementById("logoutLink");
    const hamburger = document.getElementById("hamburger");
    const overlay = document.getElementById("overlay");
    const pages = document.querySelectorAll(".page-section");
    const loginModalEl = document.getElementById("loginModal");
    const loginModal = new bootstrap.Modal(loginModalEl);
    const loginForm = document.getElementById("loginForm");
    const btnLogin = document.getElementById("btnLogin");

    // Dashboard stats elements
    const statSolar = document.getElementById("statSolar");
    const statWater = document.getElementById("statWater");
    const statAlerts = document.getElementById("statAlerts");

    // Chart Variables
    let chartSolar = null;
    let chartWater = null;
    let chartAlerts = null;

    // Manage Units elements
    const unitForm = document.getElementById("unitForm");
    const inputUnitName = document.getElementById("inputUnitName");
    const selectUnitStatus = document.getElementById("selectUnitStatus");
    const unitsTableBody = document.querySelector("#unitsTable tbody");

    // Water level and purification control elements
    const waterLevelDesc = document.getElementById("waterLevelDesc");
    const waterLevelImg = document.getElementById("waterLevelImg");
    const btnStartPurify = document.getElementById("btnStartPurify");
    const btnStopPurify = document.getElementById("btnStopPurify");
    const purifyStatus = document.getElementById("purifyStatus");

    // Storage Keys
    const STORAGE_UNITS = "solarPurify_units";
    const STORAGE_CHARTS = "solarPurify_charts";

    // Purification interval variable
    let purificationInterval = null;

    let loggedIn = false;
    let editingUnitId = null;

    // Water level simulation state
    let waterLevel = 80; // percent 0-100
    let purificationRunning = false;

    // Save & Load Units from localStorage
    function getUnits() {
      try {
        const data = localStorage.getItem(STORAGE_UNITS);
        return data ? JSON.parse(data) : [];
      } catch {
        return [];
      }
    }
    function saveUnits(units) {
      localStorage.setItem(STORAGE_UNITS, JSON.stringify(units));
    }

    // Save & Load chart data
    function getChartData() {
      try {
        const data = localStorage.getItem(STORAGE_CHARTS);
        return data ? JSON.parse(data) : null;
      } catch {
        return null;
      }
    }
    function saveChartData(data) {
      localStorage.setItem(STORAGE_CHARTS, JSON.stringify(data));
    }

    // Generate example chart data if none exists
    function generateChartData() {
      const today = new Date();
      const labels = [];
      for (let i = 6; i >= 0; i--) {
        const d = new Date(today);
        d.setDate(today.getDate() - i);
        labels.push(d.toISOString().slice(0, 10));
      }

      const data = {
        waterLiters: [1300, 1550, 1780, 1650, 2200, 2520, 2350],
        alerts: [2, 3, 1, 0, 4, 2, 1],
        labels,
      };
      saveChartData(data);
      return data;
    }

    // Escape HTML text helper
    function escapeHTML(text) {
      const div = document.createElement("div");
      div.textContent = text;
      return div.innerHTML;
    }

    // Show page exclusively by ID, hide others
    function showPage(id) {
      pages.forEach((p) => {
        if (p.id === id) {
          p.classList.remove("d-none");
          p.setAttribute("tabindex", "0");
          p.focus();
        } else {
          p.classList.add("d-none");
          p.removeAttribute("tabindex");
        }
      });

      // Mark active link
      sidebarLinks.forEach((link) => {
        link.classList.toggle("active", link.dataset.page === id);
      });

      // Adjust main margin for sidebar visibility
      if (loggedIn) {
        document.querySelector("main.content").classList.add("with-sidebar");
      } else {
        document.querySelector("main.content").classList.remove("with-sidebar");
      }
    }

    // Toggle Sidebar on Mobile
    function openSidebar() {
      sidebar.classList.add("open");
      sidebar.classList.remove("hidden");
      overlay.classList.add("show");
      hamburger.setAttribute("aria-expanded", "true");
      // Focus first link
      const firstLink = sidebar.querySelector("nav a");
      if (firstLink) firstLink.focus();
    }
    function closeSidebar() {
      sidebar.classList.remove("open");
      overlay.classList.remove("show");
      hamburger.setAttribute("aria-expanded", "false");
      hamburger.focus();
    }

    // Event Listeners

    hamburger.addEventListener("click", () => {
      if (sidebar.classList.contains("open")) closeSidebar();
      else openSidebar();
    });

    overlay.addEventListener("click", closeSidebar);

    // Sidebar nav links navigation
    sidebarLinks.forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();
        const target = link.dataset.page;

        // Block access before login for dashboard & manage
        if (!loggedIn && (target === "dashboard" || target === "manage")) {
          alert("Please log in first.");
          openLoginModal();
          closeSidebar();
          return;
        }

        showPage(target);
        closeSidebar();
      });
    });

    logoutLink.addEventListener("click", (e) => {
      e.preventDefault();
      if (confirm("Log out now?")) {
        logout();
      }
    });

    btnLogin.addEventListener("click", (e) => {
      openLoginModal();
    });

    // Login modal show helper
    function openLoginModal() {
      cleanValidation(loginForm);
      loginForm.reset();
      loginModal.show();
    }

    // Form validation helpers
    function validateForm(form) {
      let valid = true;
      Array.from(form.elements).forEach((el) => {
        if (el.willValidate && !el.checkValidity()) {
          el.classList.add("is-invalid");
          valid = false;
        } else {
          el.classList.remove("is-invalid");
        }
      });
      return valid;
    }
    function cleanValidation(form) {
      Array.from(form.elements).forEach((el) => el.classList.remove("is-invalid"));
    }

    // Login form submit event
    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      if (!validateForm(loginForm)) return;
      const username = loginForm.username.value.trim();
      const password = loginForm.password.value;
      if (username === USER && password === PASS) {
        loginModal.hide();
        loginSuccess();
      } else {
        alert("Invalid username or password.");
      }
    });

    // Remove invalid state on input in login fields
    ["username", "password"].forEach((id) => {
      loginForm[id].addEventListener("input", () => {
        loginForm[id].classList.remove("is-invalid");
      });
    });

    // Login success handler - no alert, direct go to dashboard
    function loginSuccess() {
      loggedIn = true;
      sidebar.classList.remove("hidden");
      hamburger.style.display = "block";
      showPage("dashboard");
      updateDashboard();
      updateWaterLevelDisplay();
      enablePurificationButtons();
    }

    // Logout handler
    function logout() {
      loggedIn = false;
      sidebar.classList.add("hidden");
      hamburger.style.display = "none";
      showPage("welcome");
      clearManageUnitsForm();
      unitsTableBody.innerHTML = "";
      destroyCharts();
      resetWaterAndPurificationState();
      disablePurificationButtons();
    }

    // Manage Units functions
    function clearManageUnitsForm() {
      inputUnitName.value = "";
      selectUnitStatus.value = "";
      editingUnitId = null;
      unitForm.querySelector("button[type='submit']").innerHTML =
        '<i class="bi bi-plus-circle me-2"></i>Add Unit';
      cleanValidation(unitForm);
    }

    // Render units to table
    function renderUnits() {
      const units = getUnits();
      unitsTableBody.innerHTML = "";

      if (units.length === 0) {
        unitsTableBody.innerHTML =
          '<tr><td colspan="3" class="text-center text-muted">No units added yet.</td></tr>';
        updateDashboard();
        return;
      }

      units.forEach((u) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${escapeHTML(u.name)}</td>
          <td>${escapeHTML(u.status)}</td>
          <td class="text-center">
            <button class="btn btn-sm btn-outline-warning me-2" aria-label="Edit unit ${
              escapeHTML(u.name)
            }"><i class="bi bi-pencil-square"></i></button>
            <button class="btn btn-sm btn-outline-danger" aria-label="Delete unit ${
              escapeHTML(u.name)
            }"><i class="bi bi-trash"></i></button>
          </td>
        `;

        // Edit unit
        tr.querySelector(".btn-outline-warning").addEventListener("click", () => {
          editUnit(u.id);
        });

        // Delete unit
        tr.querySelector(".btn-outline-danger").addEventListener("click", () => {
          if (confirm(`Delete unit "${u.name}"? This action cannot be undone.`)) {
            deleteUnit(u.id);
          }
        });

        unitsTableBody.appendChild(tr);
      });

      updateDashboard();
    }

    // Add or update unit form submission
    unitForm.addEventListener("submit", (e) => {
      e.preventDefault();
      if (!validateForm(unitForm)) return;

      const units = getUnits();
      const name = inputUnitName.value.trim();
      const status = selectUnitStatus.value;

      if (editingUnitId) {
        // Update existing
        const idx = units.findIndex((u) => u.id === editingUnitId);
        if (idx >= 0) {
          units[idx].name = name;
          units[idx].status = status;
          saveUnits(units);
        }
        editingUnitId = null;
        unitForm.querySelector(
          "button[type='submit']"
        ).innerHTML = `<i class="bi bi-plus-circle me-2"></i>Add Unit`;
      } else {
        // Add new
        units.push({ id: crypto.randomUUID(), name, status });
        saveUnits(units);
      }

      clearManageUnitsForm();
      renderUnits();
    });

    // Edit unit helper
    function editUnit(id) {
      const units = getUnits();
      const unit = units.find((u) => u.id === id);
      if (!unit) return;

      inputUnitName.value = unit.name;
      selectUnitStatus.value = unit.status;
      editingUnitId = id;
      unitForm.querySelector(
        "button[type='submit']"
      ).innerHTML = `<i class="bi bi-check-circle me-2"></i>Update Unit`;
      inputUnitName.focus();
    }

    // Delete unit helper
    function deleteUnit(id) {
      let units = getUnits();
      units = units.filter((u) => u.id !== id);
      saveUnits(units);
      if (editingUnitId === id) {
        editingUnitId = null;
        clearManageUnitsForm();
      }
      renderUnits();
    }

    // Update Dashboard info and charts
    function updateDashboard() {
      const units = getUnits();

      // Stats calculations
      const countActive = units.filter((u) => u.status === "Active").length;
      const countMaintenance = units.filter((u) => u.status === "Maintenance").length;

      statSolar.textContent = countActive;
      statWater.textContent = Math.min(countActive * 1200 + 500, 10000);
      statAlerts.textContent = countMaintenance;

      // Chart data generation / retrieval
      const chartData = getChartData() || generateChartData();

      // Destroy old charts if exist
      if (chartSolar) chartSolar.destroy();
      if (chartWater) chartWater.destroy();
      if (chartAlerts) chartAlerts.destroy();

      // Solar usage: doughnut (active vs total)
      const ctxSolar = document.getElementById("chartSolar").getContext("2d");
      chartSolar = new Chart(ctxSolar, {
        type: "doughnut",
        data: {
          labels: ["Active", "Inactive"],
          datasets: [
            {
              data: [countActive, Math.max(0, units.length - countActive)],
              backgroundColor: ["#ffca28", "#3949ab"],
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: "bottom",
              labels: { color: "#1a237e", font: { weight: "600" } },
            },
          },
        },
      });

      // Water purified volume: bar chart over 7 days
      const ctxWater = document.getElementById("chartWater").getContext("2d");
      chartWater = new Chart(ctxWater, {
        type: "bar",
        data: {
          labels: chartData.labels,
          datasets: [
            {
              label: "Liters Purified",
              data: chartData.waterLiters,
              backgroundColor: "#1a237e",
              borderRadius: 6,
              borderSkipped: false,
            },
          ],
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true },
            x: { grid: { display: false } },
          },
          plugins: {
            legend: { display: false },
          },
        },
      });

      // Alerts over time: line chart
      const ctxAlerts = document.getElementById("chartAlerts").getContext("2d");
      chartAlerts = new Chart(ctxAlerts, {
        type: "line",
        data: {
          labels: chartData.labels,
          datasets: [
            {
              label: "Alerts",
              data: chartData.alerts,
              borderColor: "#ff7043",
              backgroundColor: "rgba(255,112,67,0.3)",
              fill: true,
              tension: 0.4,
              pointRadius: 5,
              pointHoverRadius: 7,
            },
          ],
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true, ticks: { precision: 0 } },
            x: { grid: { display: false } },
          },
          plugins: {
            legend: {
              labels: {
                color: "#1a237e",
              },
            },
          },
        },
      });
    }

    // Destroy charts helper for proper cleanup on logout
    function destroyCharts() {
      if (chartSolar) {
        chartSolar.destroy();
        chartSolar = null;
      }
      if (chartWater) {
        chartWater.destroy();
        chartWater = null;
      }
      if (chartAlerts) {
        chartAlerts.destroy();
        chartAlerts = null;
      }
    }

    // Water Level Display Update
    function updateWaterLevelDisplay() {
      waterLevelDesc.textContent = `Current water level: ${waterLevel}%`;
      if (waterLevel >= 75) {
        waterLevelImg.src =
          "https://www.shutterstock.com/image-vector/water-tank-leak-vector-illustration-260nw-2437799489.jpg";
        waterLevelImg.alt = "Water tank almost full";
      } else if (waterLevel >= 40) {
        waterLevelImg.src =
          "https://images.squarespace-cdn.com/content/v1/62df95289f911a51f011fa7e/54fc0373-7004-4348-8c2f-d20def73e5f6/Asset+8.png";
        waterLevelImg.alt = "Water tank at medium level";
      } else {
        waterLevelImg.src =
          "https://i.pinimg.com/736x/7e/77/9c/7e779c5ec718a438a6a253498321cc27.jpg";
        waterLevelImg.alt = "Water tank low level";
      }
    }

    // Purification Controls Logic
    btnStartPurify.addEventListener("click", () => {
      if (purificationRunning) return;
      if (waterLevel < 30) {
        purifyStatus.textContent =
          "Water level too low to start purification. Please refill the tank.";
        purifyStatus.style.color = "darkred";
        return;
      }
      purificationRunning = true;
      purifyStatus.textContent = "Purification process is running...";
      purifyStatus.style.color = "green";
      btnStartPurify.disabled = true;
      btnStopPurify.disabled = false;

      // Simulate purification and water consumption every 1.5 seconds
      purificationInterval = setInterval(() => {
        if (waterLevel <= 5) {
          purifyStatus.textContent =
            "Water level critically low — purification stopped to avoid damage.";
          purifyStatus.style.color = "darkred";
          stopPurification();
          return;
        }
        waterLevel = Math.max(0, waterLevel - 3);
        updateWaterLevelDisplay();
      }, 1500);
    });

    btnStopPurify.addEventListener("click", () => {
      if (!purificationRunning) return;
      stopPurification();
      purifyStatus.textContent = "Purification process stopped.";
      purifyStatus.style.color = "orange";
    });

    function stopPurification() {
      purificationRunning = false;
      if (purificationInterval) {
        clearInterval(purificationInterval);
        purificationInterval = null;
      }
      btnStartPurify.disabled = false;
      btnStopPurify.disabled = true;
    }

    function resetWaterAndPurificationState() {
      waterLevel = 80;
      updateWaterLevelDisplay();
      purifyStatus.textContent = "";
      btnStartPurify.disabled = true;
      btnStopPurify.disabled = true;
      purificationRunning = false;
      if (purificationInterval) {
        clearInterval(purificationInterval);
        purificationInterval = null;
      }
    }

    function enablePurificationButtons() {
      btnStartPurify.disabled = false;
      btnStopPurify.disabled = true;
    }
    function disablePurificationButtons() {
      btnStartPurify.disabled = true;
      btnStopPurify.disabled = true;
    }

    // Initialization
    showPage("welcome");
    sidebar.classList.add("hidden");
    hamburger.style.display = "none";
    resetWaterAndPurificationState();

  
    // Accessibility: Close sidebar with Escape key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && sidebar.classList.contains("open")) {
        closeSidebar();
      }
    });
  })();
</script>
</body>
</html>
